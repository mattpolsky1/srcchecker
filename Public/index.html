<!DOCTYPE html>
<html>
<head>
    <title>Gym Attendance</title>
    <style>
        body {
            font-family: 'Gotham Bold', Arial, sans-serif;
            background-color: #b6d0e8;
            text-align: center;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            position: relative;
        }

        h1 {
            font-size: 72px; /* Larger font size */
            font-weight: bold;
            color: #295296;
        }

        #peopleAtGym {
            font-size: 100px; /* Larger font size */
            font-weight: bold;
            color: #295296;
            text-align: center;
            margin-bottom: 20px;
        }

        #status {
            font-size: 24px; /* Larger font size */
            font-weight: bold;
            color: #5b5857;
            position: absolute;
            top: 10px;
            right: 10px;
        }

        #gymStatus {
            font-size: 36px; /* Adjusted font size */
            font-weight: bold;
            color: #295296;
            text-align: center; /* Center the text */
            margin-top: 20px;
        }

        button.checkIn {
            font-size: 48px; /* Larger font size for mobile */
            font-weight: bold;
            padding: 30px 60px; /* Larger button size */
            background-color: #295296;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 30px;
            display: block;
        }

        button.checkIn.hidden {
            display: none; /* Hide the button */
        }

        button.checkOut {
            font-size: 48px;
            font-weight: bold;
            padding: 30px 60px;
            background-color: #FF5733;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-top: 30px;
            display: block;
        }

        button:hover {
            background-color: #0056b3;
        }

        #logo {
            font-size: 14px;
            font-weight: bold;
            position: fixed;
            bottom: 0;
            left: 0;
            color: #5b5857;
        }

        /* Style to position the image at the bottom left */
        #logo img {
            width: 250px; /* Slightly larger logo */
            height: auto;
        }

        /* Media query for small screens (mobile devices) */
        @media screen and (max-width: 768px) {
            #peopleAtGym {
                font-size: 72px; /* Larger font size */
            }

            #status {
                font-size: 24px; /* Larger font size */
                position: static;
            }

            #gymStatus {
                font-size: 30px; /* Adjusted font size */
            }
        }
    </style>
</head>
<body>
<h1>People at the Gym: <span id="peopleAtGym">0</span></h1>
<div id="status">Status: <span id="statusLabel">Checked Out</span></div>
<div id="gymStatus">Gym Status: <span id="gymStatusLabel">Empty</span></div>
<button id="toggleCheckInButton" class="checkIn">Check In</button>
<div id="logo">
    <img id="myImage" src="https://i.ibb.co/gPhHQ7f/campushoopslogo-02.png" alt="campushoopslogo-02">
</div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBrWbBamD1cA1NL9Q3Mt1Izml4WwZlzncs&libraries=geometry&callback=initMap"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>

const peopleAtGymElement = document.getElementById("peopleAtGym");
        const toggleCheckInButton = document.getElementById("toggleCheckInButton");
        const statusLabel = document.getElementById("statusLabel");
        const gymStatusLabel = document.getElementById("gymStatusLabel");

        const socket = io();

        let checkedIn = false;
        const cookieKey = "checkInStatus";

        // Initialize check-in status on page load
        document.addEventListener("DOMContentLoaded", () => {
            socket.emit('requestCheckInStatus');
            socket.on('responseCheckInStatus', (checkInStatus) => {
                handleCheckInStatus(checkInStatus);
            });
            
            // Request the checked-out cookie when the page loads
            socket.emit('requestCheckOutCookie');
        });

        // Event listener for the Check-In button
        toggleCheckInButton.addEventListener("click", () => {
            socket.emit('checkIn');
        });

        // Event listener for updating count
        socket.on('updateCount', (count) => {
            updateCount(count);
        });

        // Event listener for checked-in status
        socket.on('checkedInStatus', () => {
            handleCheckInStatus(true);
        });

        // Event listener for checked-out status
        socket.on('checkedOutStatus', () => {
            handleCheckInStatus(false);
        });

        socket.on('setCheckedOutCookie', (checkedOutCookie) => {
            document.cookie = checkedOutCookie;
        });

        function handleCheckInStatus(isCheckedIn) {
            checkedIn = isCheckedIn;
            updateUI();
        }

        function updateUI() {
            toggleCheckInButton.style.display = checkedIn ? "none" : "block";
            statusLabel.textContent = checkedIn ? "Checked In" : "Checked Out";
            statusLabel.style.color = checkedIn ? "#295296" : "#FF5733";
            updateGymStatusLabel();
        }

        function updateGymStatusLabel() {
            const count = parseInt(peopleAtGymElement.textContent, 10);
            gymStatusLabel.textContent = count > 50 ? "Packed" : "Empty";
            gymStatusLabel.style.color = count > 50 ? "#FF5733" : "#295296";
        }

        function updateCount(count) {
            peopleAtGymElement.textContent = count;
            updateGymStatusLabel();
        }
    </script>
</body>
</html>